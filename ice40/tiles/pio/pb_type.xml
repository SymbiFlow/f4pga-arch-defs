 <pb_type name="PIO">
   <clock name="OUTPUT_CLK" num_pins="1"/>
   <clock name="INPUT_CLK"  num_pins="1"/>
   <input name="CLOCK_ENABLE" num_pins="1" equivalent="false"/>

   <input name="LATCH_INPUT_VALUE" num_pins="2" equivalent="false"/>
   <output name="D_IN_1" num_pins="2" equivalent="false"/>
   <output name="D_IN_0" num_pins="2" equivalent="false"/>

   <input name="D_OUT_1" num_pins="2" equivalent="false"/>
   <input name="D_OUT_0" num_pins="2" equivalent="false"/>
   <input name="OUTPUT_ENABLE" num_pins="2" equivalent="false"/>

   <pb_type name="IO" num_pb="2">
    <clock name="OUTPUT_CLK" num_pins="1"/>
    <clock name="INPUT_CLK"  num_pins="1"/>
    <input name="CLOCK_ENABLE" num_pins="1" equivalent="false"/>

    <input name="LATCH_INPUT_VALUE" num_pins="1" equivalent="false"/>
    <output name="D_IN_1" num_pins="1" equivalent="false"/>
    <output name="D_IN_0" num_pins="1" equivalent="false"/>

    <input name="D_OUT_1" num_pins="1" equivalent="false"/>
    <input name="D_OUT_0" num_pins="1" equivalent="false"/>
    <input name="OUTPUT_ENABLE" num_pins="1" equivalent="false"/>

    <!-- FlipFlops -->
    <pb_type name="IN_FF" num_pb="2" class="flipflop" blif_model=".latch">
     <clock  name="clk" num_pins="1" port_class="clock" />
     <input  name="D"  num_pins="1" port_class="D" />
     <output name="Q"  num_pins="1" port_class="Q" />
     <T_setup value="2.448e-10" port="IN_FF.D" clock="clk"/>
     <T_clock_to_Q max="7.732e-11" port="IN_FF.Q" clock="clk"/>
    </pb_type>
    <pb_type name="OUT_FF" num_pb="2" class="flipflop" blif_model=".latch">
     <clock  name="clk" num_pins="1" port_class="clock" />
     <input  name="D"  num_pins="1" port_class="D" />
     <output name="Q"  num_pins="1" port_class="Q" />
     <T_setup value="2.448e-10" port="OUT_FF.D" clock="clk"/>
     <T_clock_to_Q max="7.732e-11" port="OUT_FF.Q" clock="clk"/>
    </pb_type>
    <pb_type name="OE_FF" num_pb="1" class="flipflop" blif_model=".latch">
     <clock  name="clk" num_pins="1" port_class="clock" />
     <input  name="D"  num_pins="1" port_class="D" />
     <output name="Q"  num_pins="1" port_class="Q" />
     <T_setup value="2.448e-10" port="OE_FF.D" clock="clk"/>
     <T_clock_to_Q max="7.732e-11" port="OE_FF.Q" clock="clk"/>
    </pb_type>

    <!-- MUX -->
    <pb_type name="INPUT_MUX" num_pb="1" blif_model=".subckt MUX4">
     <input  name="S"  num_pins="2" />
     <input  name="I"  num_pins="4" />
     <output name="O"  num_pins="1" />
     <delay_constant max="10e-12" in_port="INPUT_MUX.I" out_port="INPUT_MUX.O"/>
     <delay_constant max="10e-12" in_port="INPUT_MUX.S" out_port="INPUT_MUX.O"/>
    </pb_type>
    <pb_type name="OUTPUT_MUX" num_pb="1" blif_model=".subckt MUX4">
     <input  name="S"  num_pins="2" />
     <input  name="I"  num_pins="4" />
     <output name="O"  num_pins="1" />
     <delay_constant max="10e-12" in_port="OUTPUT_MUX.I[3:0]" out_port="OUTPUT_MUX.O"/>
     <delay_constant max="10e-12" in_port="OUTPUT_MUX.S[1:0]" out_port="OUTPUT_MUX.O"/>
    </pb_type>

    <pb_type name="CLK_IN_MUX" num_pb="1" blif_model=".subckt MUX2">
     <input  name="S"  num_pins="1" />
     <input  name="I"  num_pins="2" />
     <output name="O"  num_pins="1" />
     <delay_constant max="10e-12" in_port="CLK_IN_MUX.I[1:0]" out_port="CLK_IN_MUX.O"/>
     <delay_constant max="10e-12" in_port="CLK_IN_MUX.S"  out_port="CLK_IN_MUX.O"/>
    </pb_type>
    <pb_type name="CLK_OUT_MUX" num_pb="1" blif_model=".subckt MUX2">
     <input  name="S"  num_pins="1" />
     <input  name="I"  num_pins="2" />
     <output name="O"  num_pins="1" />
     <delay_constant max="10e-12" in_port="CLK_OUT_MUX.I[1:0]" out_port="CLK_OUT_MUX.O"/>
     <delay_constant max="10e-12" in_port="CLK_OUT_MUX.S"  out_port="CLK_OUT_MUX.O"/>
    </pb_type>

    <!-- Pads -->
    <pb_type name="PAD" num_pb="1">
     <input  name="EN_N" num_pins="1" />
     <output name="I"    num_pins="1" />
     <input  name="O"    num_pins="1" />

     <mode name="inpad">
      <pb_type name="inpad" blif_model=".input" num_pb="1">
       <output  name="inpad" num_pins="1"/>
      </pb_type>
      <interconnect>
       <direct name="IN"  input="inpad.inpad" output="PAD.I"   />
      </interconnect>
     </mode>
     <mode name="outpad">
      <pb_type name="outpad" blif_model=".output" num_pb="1">
       <input name="outpad" num_pins="1"/>
      </pb_type>
      <interconnect>
       <direct name="OUT" input="PAD.O" output="outpad.outpad" />
      </interconnect>
     </mode>
    </pb_type>

    <interconnect>
     <!-- Clock enable -->
     <!--
     <complete name="DISABLED_CLK" input="GND"             output="CLK_IN_MUX.I[1:1] CLK_OUT_MUX.I[1:1]" />
     -->
     <direct   name="INPUT_CLK"    input="IO.INPUT_CLK"    output="CLK_IN_MUX.I[0:0]"/>
     <direct   name="OUTPUT_CLK"   input="IO.OUTPUT_CLK"   output="CLK_OUT_MUX.I[0:0]"/>
     <complete name="CLOCK_SELECT" input="IO.CLOCK_ENABLE" output="CLK_IN_MUX.S CLK_OUT_MUX.S" />

     <!-- Input flip flops -->
     <complete name="IN_FF_CLK"    input="CLK_IN_MUX.O"    output="IN_FF[1:0].clk" />
     <complete name="PAD_INPUT_N0" input="PAD.I"           output="IN_FF[1:0].D INPUT_MUX.I[2:2]" />
     <direct   name="PAD_INPUT_N1" input="IN_FF[1:1].Q"    output="IO.D_IN_1" />
     <direct   name="PAD_INPUT_N2" input="IN_FF[0:0].Q"    output="INPUT_MUX.I[3:3]" />

     <!-- Input selection MUX -->
     <direct   name="INPUT_MUX_S0" input="IO.LATCH_INPUT_VALUE" output="INPUT_MUX.S[0:0]" />
     <!--
     <mux      name="INPUT_MUX_S1" input="GND VCC"              output="INPUT_MUX.S[1:1]" />
     -->
     <!--      name="INPUT_MUX_I0" input="INPUT_MUX.O"          output="INPUT_MUX.I[0:0]" -->
     <!--      name="INPUT_MUX_I1" input="INPUT_MUX.O"          output="INPUT_MUX.I[1:1]" -->
     <!--      name="INPUT_MUX_I2" input="PAD.I"                output="INPUT_MUX.I[2:2]" -->
     <!--      name="INPUT_MUX_I3" input="IN_FF[0:0].Q"         output="INPUT_MUX.I[3:3]" -->

     <complete name="INPUT_MUX_O"  input="INPUT_MUX.O" output="INPUT_MUX.I[1:0] IO.D_IN_0"/>

     <!-- Output enable MUX -->
     <!--
     <mux name="OE_MUX" input="GND VCC IO.OUTPUT_ENABLE OE_FF.D" output="PAD.EN_N" />
     -->
     <mux name="OE_MUX" input="IO.OUTPUT_ENABLE OE_FF.Q" output="PAD.EN_N" />

     <!-- FIXME: Properly describe the output mux cascade... -->

     <!-- Output flipflops -->
     <complete name="OUT_FF_CLK" input="CLK_OUT_MUX.O" output="OUT_FF[1:0].clk OE_FF.clk" />
     <direct   name="D_OUT_0"    input="IO.D_OUT_0"    output="OUT_FF[0:0].D" />
     <direct   name="D_OUT_1"    input="IO.D_OUT_1"    output="OUT_FF[1:1].D" />
    </interconnect>
   </pb_type>

   <interconnect>
    <complete name="CLOCK_ENABLE" input="PIO.CLOCK_ENABLE" output="IO[1:0].CLOCK_ENABLE" />
    <complete name="OUTPUT_CLK"   input="PIO.OUTPUT_CLK"   output="IO[1:0].OUTPUT_CLK" />
    <complete name="INPUT_CLK"    input="PIO.INPUT_CLK"    output="IO[1:0].INPUT_CLK" />

    <complete name="D_IN_0"       input="IO[1:0].D_IN_0"   output="PIO.D_IN_0"      />
    <complete name="D_IN_1"       input="IO[1:0].D_IN_1"   output="PIO.D_IN_1"      />
    <complete name="D_OUT_0"      input="PIO.D_OUT_0"      output="IO[1:0].D_OUT_0" />
    <complete name="D_OUT_1"      input="PIO.D_OUT_1"      output="IO[1:0].D_OUT_1" />
    <complete name="LAT_INPUT_VALUE"  input="PIO.LATCH_INPUT_VALUE"  output="IO[1:0].LATCH_INPUT_VALUE" />
    <complete name="OUTPUT_ENABLE"    input="PIO.OUTPUT_ENABLE"      output="IO[1:0].OUTPUT_ENABLE" />
   </interconnect>

   <fc default_in_type="frac" default_in_val="0.15" default_out_type="frac" default_out_val="0.10"/>

   <pinlocations pattern="spread"/>
 </pb_type>
